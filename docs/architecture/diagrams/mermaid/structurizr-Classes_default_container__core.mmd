graph TB
  linkStyle default fill:#ffffff

  subgraph diagram ["Application - Application - Components"]
    style diagram fill:#ffffff,stroke:#ffffff

    subgraph 8 ["Application"]
      style 8 fill:#ffffff,stroke:#2e6295,color:#2e6295

      34("<div style='font-weight: bold'>core.resolveConfigFilePath</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Resolve config file path from<br />CLI arguments</div>")
      style 34 fill:#85bbf0,stroke:#5d82a8,color:#000000
      35("<div style='font-weight: bold'>core.resolveConfigBaseDir</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Determine base directory for<br />resolving config-relative<br />paths Logic: - If using<br />default template: CWD (user's<br />project directory) - If user<br />provided config file: config<br />file's directory - Fallback:<br />CWD</div>")
      style 35 fill:#85bbf0,stroke:#5d82a8,color:#000000
      36("<div style='font-weight: bold'>core.loadYamlFile</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Load and parse YAML config<br />file</div>")
      style 36 fill:#85bbf0,stroke:#5d82a8,color:#000000
      37("<div style='font-weight: bold'>core.createDefaultConfig</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Create minimal default<br />configuration when no config<br />file is found</div>")
      style 37 fill:#85bbf0,stroke:#5d82a8,color:#000000
      38("<div style='font-weight: bold'>core.loadConfig</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Load configuration from file<br />path (high-level API) This is<br />the main entry point for<br />config loading. It handles:<br />1. Config file path<br />resolution (default vs<br />user-provided) 2. Base<br />directory determination 3.<br />YAML parsing 4. Config<br />validation and resolution 5.<br />Fallback to default config</div>")
      style 38 fill:#85bbf0,stroke:#5d82a8,color:#000000
      39("<div style='font-weight: bold'>core.nameToId</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Convert a name to a<br />normalized ID Used for<br />consistent ID generation<br />across extractors and mappers</div>")
      style 39 fill:#85bbf0,stroke:#5d82a8,color:#000000
      40("<div style='font-weight: bold'>core.sanitizeId</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Sanitize ID for DSL and code<br />identifiers (preserves<br />underscores) Used for Python<br />code identifiers where<br />underscores are significant</div>")
      style 40 fill:#85bbf0,stroke:#5d82a8,color:#000000
      41("<div style='font-weight: bold'>core.isTTY</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Determine if we're in a TTY<br />environment (for pretty<br />printing)</div>")
      style 41 fill:#85bbf0,stroke:#5d82a8,color:#000000
      42("<div style='font-weight: bold'>core.getDefaultLogLevel</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Get default log level from<br />environment or fallback to<br />'info'</div>")
      style 42 fill:#85bbf0,stroke:#5d82a8,color:#000000
      43("<div style='font-weight: bold'>core.createPinoLogger</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Create a Pino logger instance<br />with optional pretty printing</div>")
      style 43 fill:#85bbf0,stroke:#5d82a8,color:#000000
      44("<div style='font-weight: bold'>core.createLogger</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Create a logger instance</div>")
      style 44 fill:#85bbf0,stroke:#5d82a8,color:#000000
      45("<div style='font-weight: bold'>core.getDefaultUserPluginDir</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Default base directory for<br />user plugins:<br />~/.archlette/mods This<br />provides a standard location<br />for external plugins and<br />custom modules</div>")
      style 45 fill:#85bbf0,stroke:#5d82a8,color:#000000
      46("<div style='font-weight: bold'>core.loadModuleFromPath</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Dynamically load an ESM<br />module from a path or module<br />specifier with security<br />validation</div>")
      style 46 fill:#85bbf0,stroke:#5d82a8,color:#000000
      47("<div style='font-weight: bold'>core.getCliDir</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div>")
      style 47 fill:#85bbf0,stroke:#5d82a8,color:#000000
      48("<div style='font-weight: bold'>core.expandTilde</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div>")
      style 48 fill:#85bbf0,stroke:#5d82a8,color:#000000
      49("<div style='font-weight: bold'>core.resolveArchlettePath</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Core path resolver honoring<br />Archlette rules (no file<br />existence checks). - "~" -><br />user home - "/" -> absolute -<br />else -> relative to CLI dir</div>")
      style 49 fill:#85bbf0,stroke:#5d82a8,color:#000000
      50("<div style='font-weight: bold'>core.resolveModuleEntry</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Resolve a module entry by<br />probing: 1) Exact path 2)<br />With extensions: .ts then .js<br />3) If directory: index.ts<br />then index.js</div>")
      style 50 fill:#85bbf0,stroke:#5d82a8,color:#000000
      51("<div style='font-weight: bold'>core.toFileUrl</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div>")
      style 51 fill:#85bbf0,stroke:#5d82a8,color:#000000
      52("<div style='font-weight: bold'>core.writeFile</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Write content to a file,<br />creating parent directories<br />if needed.</div>")
      style 52 fill:#85bbf0,stroke:#5d82a8,color:#000000
      53("<div style='font-weight: bold'>core.validatePathSecurity</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Validate path for security<br />issues</div>")
      style 53 fill:#85bbf0,stroke:#5d82a8,color:#000000
      54("<div style='font-weight: bold'>core.resolveSecurePath</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Securely resolve a<br />user-provided path with<br />validation</div>")
      style 54 fill:#85bbf0,stroke:#5d82a8,color:#000000
      55("<div style='font-weight: bold'>core.resolveUserContentPath</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Convenience function for<br />resolving user content paths<br />(themes, input files) Uses<br />'config-relative' strategy by<br />default</div>")
      style 55 fill:#85bbf0,stroke:#5d82a8,color:#000000
      56("<div style='font-weight: bold'>core.resolvePluginPath</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Convenience function for<br />resolving plugin paths Uses<br />'cli-relative' strategy by<br />default</div>")
      style 56 fill:#85bbf0,stroke:#5d82a8,color:#000000
      57("<div style='font-weight: bold'>core.getStageEntry</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div>")
      style 57 fill:#85bbf0,stroke:#5d82a8,color:#000000
      58("<div style='font-weight: bold'>core.loadExtractorModule</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div>")
      style 58 fill:#85bbf0,stroke:#5d82a8,color:#000000
      59("<div style='font-weight: bold'>core.loadValidatorModule</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div>")
      style 59 fill:#85bbf0,stroke:#5d82a8,color:#000000
      60("<div style='font-weight: bold'>core.loadGeneratorModule</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div>")
      style 60 fill:#85bbf0,stroke:#5d82a8,color:#000000
      61("<div style='font-weight: bold'>core.loadRendererModule</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div>")
      style 61 fill:#85bbf0,stroke:#5d82a8,color:#000000
      62("<div style='font-weight: bold'>core.loadDocModule</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div>")
      style 62 fill:#85bbf0,stroke:#5d82a8,color:#000000
      63("<div style='font-weight: bold'>core.getCacheDir</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Get the Archlette cache<br />directory</div>")
      style 63 fill:#85bbf0,stroke:#5d82a8,color:#000000
      64("<div style='font-weight: bold'>core.ensureCacheDir</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Ensure cache directory exists</div>")
      style 64 fill:#85bbf0,stroke:#5d82a8,color:#000000
      65("<div style='font-weight: bold'>core.commandExistsInPath</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Check if a command exists in<br />PATH</div>")
      style 65 fill:#85bbf0,stroke:#5d82a8,color:#000000
      66("<div style='font-weight: bold'>core.downloadFile</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Download a file from URL to<br />destination</div>")
      style 66 fill:#85bbf0,stroke:#5d82a8,color:#000000
      67("<div style='font-weight: bold'>core.extractZip</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Extract a ZIP file (simple<br />extraction for Structurizr<br />CLI)</div>")
      style 67 fill:#85bbf0,stroke:#5d82a8,color:#000000
      68("<div style='font-weight: bold'>core.makeExecutable</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Make file executable (Unix<br />only)</div>")
      style 68 fill:#85bbf0,stroke:#5d82a8,color:#000000
      69("<div style='font-weight: bold'>core.downloadStructurizr</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Download and install<br />Structurizr CLI to cache</div>")
      style 69 fill:#85bbf0,stroke:#5d82a8,color:#000000
      70("<div style='font-weight: bold'>core.downloadPlantUML</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Download and install PlantUML<br />to cache</div>")
      style 70 fill:#85bbf0,stroke:#5d82a8,color:#000000
      71("<div style='font-weight: bold'>core.findStructurizrCLI</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Find or download Structurizr<br />CLI</div>")
      style 71 fill:#85bbf0,stroke:#5d82a8,color:#000000
      72("<div style='font-weight: bold'>core.findPlantUML</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Find or download PlantUML JAR</div>")
      style 72 fill:#85bbf0,stroke:#5d82a8,color:#000000
      73("<div style='font-weight: bold'>core.checkJava</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Verify Java is available</div>")
      style 73 fill:#85bbf0,stroke:#5d82a8,color:#000000
      74("<div style='font-weight: bold'>core.requireJava</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>Validate Java is installed<br />(throw if not)</div>")
      style 74 fill:#85bbf0,stroke:#5d82a8,color:#000000
      75("<div style='font-weight: bold'>core.resolveConfig</div><div style='font-size: 70%; margin-top: 0px'>[Component: function]</div><div style='font-size: 80%; margin-top:10px'>For each stage, resolve<br />includes/excludes for each<br />node: - If node omits<br />includes/excludes, inherit<br />from defaults. - Add<br />configBaseDir for resolving<br />config-relative paths</div>")
      style 75 fill:#85bbf0,stroke:#5d82a8,color:#000000
    end

  end