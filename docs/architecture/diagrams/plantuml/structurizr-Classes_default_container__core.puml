@startuml
set separator none
title Application - Application - Components

top to bottom direction
skinparam ranksep 60
skinparam nodesep 30

skinparam {
  arrowFontSize 10
  defaultTextAlignment center
  wrapWidth 200
  maxMessageSize 100
  defaultFontName "Arial"
}

hide stereotype

skinparam rectangle<<Application.Application.default_container__core__checkjava>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__commandexistsinpath>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__createdefaultconfig>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__createlogger>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__createpinologger>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__downloadfile>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__downloadplantuml>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__downloadstructurizr>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__ensurecachedir>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__expandtilde>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__extractzip>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__findplantuml>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__findstructurizrcli>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__getcachedir>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__getclidir>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__getdefaultloglevel>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__getdefaultuserplugindir>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__getstageentry>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__istty>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__loadconfig>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__loaddocmodule>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__loadextractormodule>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__loadgeneratormodule>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__loadmodulefrompath>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__loadrenderermodule>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__loadvalidatormodule>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__loadyamlfile>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__makeexecutable>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__nametoid>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__requirejava>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__resolvearchlettepath>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__resolveconfig>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__resolveconfigbasedir>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__resolveconfigfilepath>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__resolvemoduleentry>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__resolvepluginpath>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__resolvesecurepath>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__resolveusercontentpath>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__sanitizeid>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__tofileurl>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__validatepathsecurity>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application.default_container__core__writefile>> {
  BackgroundColor #85bbf0
  FontColor #000000
  BorderColor #5d82a8
  roundCorner 20
  shadowing false
}
skinparam rectangle<<Application.Application>> {
  BorderColor #2e6295
  FontColor #2e6295
  shadowing false
}

rectangle "Application\n<size:10>[Container: Application]</size>" <<Application.Application>> {
  rectangle "==default_container__core__resolveconfigfilepath\n<size:10>[Component: function]</size>\n\nResolve config file path from CLI arguments" <<Application.Application.default_container__core__resolveconfigfilepath>> as Application.Application.default_container__core__resolveconfigfilepath
  rectangle "==default_container__core__resolveconfigbasedir\n<size:10>[Component: function]</size>\n\nDetermine base directory for resolving config-relative paths Logic: - If using default template: CWD (user's project directory) - If user provided config file: config file's directory - Fallback: CWD" <<Application.Application.default_container__core__resolveconfigbasedir>> as Application.Application.default_container__core__resolveconfigbasedir
  rectangle "==default_container__core__loadyamlfile\n<size:10>[Component: function]</size>\n\nLoad and parse YAML config file" <<Application.Application.default_container__core__loadyamlfile>> as Application.Application.default_container__core__loadyamlfile
  rectangle "==default_container__core__createdefaultconfig\n<size:10>[Component: function]</size>\n\nCreate minimal default configuration when no config file is found" <<Application.Application.default_container__core__createdefaultconfig>> as Application.Application.default_container__core__createdefaultconfig
  rectangle "==default_container__core__loadconfig\n<size:10>[Component: function]</size>\n\nLoad configuration from file path (high-level API) This is the main entry point for config loading. It handles: 1. Config file path resolution (default vs user-provided) 2. Base directory determination 3. YAML parsing 4. Config validation and resolution 5. Fallback to default config" <<Application.Application.default_container__core__loadconfig>> as Application.Application.default_container__core__loadconfig
  rectangle "==default_container__core__nametoid\n<size:10>[Component: function]</size>\n\nConvert a name to a normalized ID Used for consistent ID generation across extractors and mappers" <<Application.Application.default_container__core__nametoid>> as Application.Application.default_container__core__nametoid
  rectangle "==default_container__core__sanitizeid\n<size:10>[Component: function]</size>\n\nSanitize ID for DSL and code identifiers (preserves underscores) Used for Python code identifiers where underscores are significant" <<Application.Application.default_container__core__sanitizeid>> as Application.Application.default_container__core__sanitizeid
  rectangle "==default_container__core__istty\n<size:10>[Component: function]</size>\n\nDetermine if we're in a TTY environment (for pretty printing)" <<Application.Application.default_container__core__istty>> as Application.Application.default_container__core__istty
  rectangle "==default_container__core__getdefaultloglevel\n<size:10>[Component: function]</size>\n\nGet default log level from environment or fallback to 'info'" <<Application.Application.default_container__core__getdefaultloglevel>> as Application.Application.default_container__core__getdefaultloglevel
  rectangle "==default_container__core__createpinologger\n<size:10>[Component: function]</size>\n\nCreate a Pino logger instance with optional pretty printing" <<Application.Application.default_container__core__createpinologger>> as Application.Application.default_container__core__createpinologger
  rectangle "==default_container__core__createlogger\n<size:10>[Component: function]</size>\n\nCreate a logger instance" <<Application.Application.default_container__core__createlogger>> as Application.Application.default_container__core__createlogger
  rectangle "==default_container__core__getdefaultuserplugindir\n<size:10>[Component: function]</size>\n\nDefault base directory for user plugins: ~/.archlette/mods This provides a standard location for external plugins and custom modules" <<Application.Application.default_container__core__getdefaultuserplugindir>> as Application.Application.default_container__core__getdefaultuserplugindir
  rectangle "==default_container__core__loadmodulefrompath\n<size:10>[Component: function]</size>\n\nDynamically load an ESM module from a path or module specifier with security validation" <<Application.Application.default_container__core__loadmodulefrompath>> as Application.Application.default_container__core__loadmodulefrompath
  rectangle "==default_container__core__getclidir\n<size:10>[Component: function]</size>" <<Application.Application.default_container__core__getclidir>> as Application.Application.default_container__core__getclidir
  rectangle "==default_container__core__expandtilde\n<size:10>[Component: function]</size>" <<Application.Application.default_container__core__expandtilde>> as Application.Application.default_container__core__expandtilde
  rectangle "==default_container__core__resolvearchlettepath\n<size:10>[Component: function]</size>\n\nCore path resolver honoring Archlette rules (no file existence checks). - "~" -> user home - "/" -> absolute - else -> relative to CLI dir" <<Application.Application.default_container__core__resolvearchlettepath>> as Application.Application.default_container__core__resolvearchlettepath
  rectangle "==default_container__core__resolvemoduleentry\n<size:10>[Component: function]</size>\n\nResolve a module entry by probing: 1) Exact path 2) With extensions: .ts then .js 3) If directory: index.ts then index.js" <<Application.Application.default_container__core__resolvemoduleentry>> as Application.Application.default_container__core__resolvemoduleentry
  rectangle "==default_container__core__tofileurl\n<size:10>[Component: function]</size>" <<Application.Application.default_container__core__tofileurl>> as Application.Application.default_container__core__tofileurl
  rectangle "==default_container__core__writefile\n<size:10>[Component: function]</size>\n\nWrite content to a file, creating parent directories if needed." <<Application.Application.default_container__core__writefile>> as Application.Application.default_container__core__writefile
  rectangle "==default_container__core__validatepathsecurity\n<size:10>[Component: function]</size>\n\nValidate path for security issues" <<Application.Application.default_container__core__validatepathsecurity>> as Application.Application.default_container__core__validatepathsecurity
  rectangle "==default_container__core__resolvesecurepath\n<size:10>[Component: function]</size>\n\nSecurely resolve a user-provided path with validation" <<Application.Application.default_container__core__resolvesecurepath>> as Application.Application.default_container__core__resolvesecurepath
  rectangle "==default_container__core__resolveusercontentpath\n<size:10>[Component: function]</size>\n\nConvenience function for resolving user content paths (themes, input files) Uses 'config-relative' strategy by default" <<Application.Application.default_container__core__resolveusercontentpath>> as Application.Application.default_container__core__resolveusercontentpath
  rectangle "==default_container__core__resolvepluginpath\n<size:10>[Component: function]</size>\n\nConvenience function for resolving plugin paths Uses 'cli-relative' strategy by default" <<Application.Application.default_container__core__resolvepluginpath>> as Application.Application.default_container__core__resolvepluginpath
  rectangle "==default_container__core__getstageentry\n<size:10>[Component: function]</size>" <<Application.Application.default_container__core__getstageentry>> as Application.Application.default_container__core__getstageentry
  rectangle "==default_container__core__loadextractormodule\n<size:10>[Component: function]</size>" <<Application.Application.default_container__core__loadextractormodule>> as Application.Application.default_container__core__loadextractormodule
  rectangle "==default_container__core__loadvalidatormodule\n<size:10>[Component: function]</size>" <<Application.Application.default_container__core__loadvalidatormodule>> as Application.Application.default_container__core__loadvalidatormodule
  rectangle "==default_container__core__loadgeneratormodule\n<size:10>[Component: function]</size>" <<Application.Application.default_container__core__loadgeneratormodule>> as Application.Application.default_container__core__loadgeneratormodule
  rectangle "==default_container__core__loadrenderermodule\n<size:10>[Component: function]</size>" <<Application.Application.default_container__core__loadrenderermodule>> as Application.Application.default_container__core__loadrenderermodule
  rectangle "==default_container__core__loaddocmodule\n<size:10>[Component: function]</size>" <<Application.Application.default_container__core__loaddocmodule>> as Application.Application.default_container__core__loaddocmodule
  rectangle "==default_container__core__getcachedir\n<size:10>[Component: function]</size>\n\nGet the Archlette cache directory" <<Application.Application.default_container__core__getcachedir>> as Application.Application.default_container__core__getcachedir
  rectangle "==default_container__core__ensurecachedir\n<size:10>[Component: function]</size>\n\nEnsure cache directory exists" <<Application.Application.default_container__core__ensurecachedir>> as Application.Application.default_container__core__ensurecachedir
  rectangle "==default_container__core__commandexistsinpath\n<size:10>[Component: function]</size>\n\nCheck if a command exists in PATH" <<Application.Application.default_container__core__commandexistsinpath>> as Application.Application.default_container__core__commandexistsinpath
  rectangle "==default_container__core__downloadfile\n<size:10>[Component: function]</size>\n\nDownload a file from URL to destination" <<Application.Application.default_container__core__downloadfile>> as Application.Application.default_container__core__downloadfile
  rectangle "==default_container__core__extractzip\n<size:10>[Component: function]</size>\n\nExtract a ZIP file (simple extraction for Structurizr CLI)" <<Application.Application.default_container__core__extractzip>> as Application.Application.default_container__core__extractzip
  rectangle "==default_container__core__makeexecutable\n<size:10>[Component: function]</size>\n\nMake file executable (Unix only)" <<Application.Application.default_container__core__makeexecutable>> as Application.Application.default_container__core__makeexecutable
  rectangle "==default_container__core__downloadstructurizr\n<size:10>[Component: function]</size>\n\nDownload and install Structurizr CLI to cache" <<Application.Application.default_container__core__downloadstructurizr>> as Application.Application.default_container__core__downloadstructurizr
  rectangle "==default_container__core__downloadplantuml\n<size:10>[Component: function]</size>\n\nDownload and install PlantUML to cache" <<Application.Application.default_container__core__downloadplantuml>> as Application.Application.default_container__core__downloadplantuml
  rectangle "==default_container__core__findstructurizrcli\n<size:10>[Component: function]</size>\n\nFind or download Structurizr CLI" <<Application.Application.default_container__core__findstructurizrcli>> as Application.Application.default_container__core__findstructurizrcli
  rectangle "==default_container__core__findplantuml\n<size:10>[Component: function]</size>\n\nFind or download PlantUML JAR" <<Application.Application.default_container__core__findplantuml>> as Application.Application.default_container__core__findplantuml
  rectangle "==default_container__core__checkjava\n<size:10>[Component: function]</size>\n\nVerify Java is available" <<Application.Application.default_container__core__checkjava>> as Application.Application.default_container__core__checkjava
  rectangle "==default_container__core__requirejava\n<size:10>[Component: function]</size>\n\nValidate Java is installed (throw if not)" <<Application.Application.default_container__core__requirejava>> as Application.Application.default_container__core__requirejava
  rectangle "==default_container__core__resolveconfig\n<size:10>[Component: function]</size>\n\nFor each stage, resolve includes/excludes for each node: - If node omits includes/excludes, inherit from defaults. - Add configBaseDir for resolving config-relative paths" <<Application.Application.default_container__core__resolveconfig>> as Application.Application.default_container__core__resolveconfig
}

@enduml